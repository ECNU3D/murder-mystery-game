# 剧本杀生成要求

## 一、通用结构要求

1.  **剧本组成：** 每个剧本都必须包含以下文件：
    *   `GM_手册.md`：游戏主持人的总览剧本。
    *   `00_公共剧本.md`：所有玩家共享的背景和案发信息。
    *   `01_角色A.md`, `02_角色B.md`, ...：每个角色的独立剧本。
2.  **角色数量：** 剧本应设计为包含 **5个核心角色** 和 **2个可选角色**，以适应不同规模的玩家群体。
3.  **游戏时长：** 剧本内容应足够丰富，能够支撑 **3至4小时** 的完整游戏体验。

## 二、GM手册核心要素

`GM_手册.md` 是剧本的灵魂，必须包含以下几个核心部分，以确保GM能够顺利地引导游戏。

### 1. 游戏概述 (Overview)
*   **故事背景：** 简要介绍剧本的时代、地点、核心冲突。
*   **玩家人数：** 明确支持的人数范围（例如5-7人）。
*   **游戏时间：** 预估的完整游戏时长。
*   **核心机制：** 概括游戏的主要玩法（例如：阵营对抗、秘密任务、多重凶案等）。

### 2. 故事真相 (The Truth)
这是手册最关键的部分，���须清晰、详尽。
*   **完整时间线 (Detailed Timeline):**
    *   必须以�����的时间顺序，梳理出**所有角色**在案发前后的**所有关键行动**。
    *   时间应尽可能精确，例如“二更三刻 (20:45)”。
*   **凶案解析 (Murder Analysis):**
    *   **明确真凶：** 如果有多起案件，需逐一指明真凶。
    *   **作案动机：** 详细解释凶手为何要杀人。
    *   **作案手法：** 描述凶手是如何完成作案的。
*   **关键线索解析 (Key Clue Analysis):**
    *   对每一条将在游戏中出现的关键线索进行详细解释。
    *   说明该线索的**作用**（例如：指向A，或洗脱B的嫌疑）。
    *   分析该线索**可能被误读的方向**，帮助GM理解玩家可能的推理偏差。

### 3. 游戏流程 (Game Flow)
*   **多幕结构 (Multi-Act Structure):**
    *   将游戏流程清晰地划分为至少**三幕**（例如：第一幕：案发之初；第二幕：深入调查；第三幕：真相大白）。
    *   为每一幕提供一个**建议的游戏时间**，帮助GM控制节奏。
*   **线索分发 (Clue Distribution):**
    *   明确规定每一轮的**线索卡**在**哪一幕**的哪个环节分发。
    *   指明线索的分发形式（例如：公开展示、仅特定玩家可见、图片线���等）。

### 4. 线索卡列表 (Clue Cards)
*   **内容明确：** 将所有线索卡的内容���整地列出。
*   **类型多样：** 线索应包含尸检报告、物证、证人证词、环境描述等不同类型。
*   **包含图片线索：** 对于关键物证或场景，应设计图片线索，并在手册中用文字占位符进行标记，格式为：`[图片: a detailed description of the image.]`

### 5. 角色配置 (Role Configuration)
*   **提供弹性方案：** 必须提供针对不同玩家人数（少于最大人数时）的调整方案。
*   **明确说明：** 清晰地说明在人数不足时，应该**去掉哪个可选角色**。
*   **GM指引：** 如果去掉的角色持有关键线索，需要指引GM如何以NPC的身份在适当的时候提供这些线索。

---

## 三、高级剧本设计元素（可选）

为了创作出更复杂、更深刻、更具可玩性的剧本，可以在构思阶段引入以下高级设计元素。

### 1. 跨时空叙事 (Time-spanning Narrative)
*   **描述：** 故事的核心矛盾源于过去发生的某个事件，而现在的案件只是那个事件的延续或结果。
*   **实现方式：**
    *   在剧本中设置 **“现在”** 和 **“过去”** 两条时间线。
    *   玩家的剧本中包含对过去事件的 **“回忆片段”**��
    *   通过线索卡，逐步揭示过去事件的真相，从而让玩家理解现在案件的真正动机。
    *   **示例：** 一场同学聚会的凶案，其根源可能在于十年前的一场校园霸凌事件。

### 2. 多重身份与阵营 (Multiple Identities & Factions)
*   **描述：** 角色除了表面身份外，还拥有隐藏的第二身份，并可能分属于不同的秘密阵营。
*   **实现方式：**
    *   在角色剧本中明确其 **“表面身份”** 和 **“隐藏身份/所属阵营”**。
    *   设置对立的阵营目标，例如【兄弟会】vs【复仇者】。
    *   玩家的首要任务可能是找出凶手，但最终目标是帮助自己的阵营获胜。
    *   **示例：** 一家公司的商业间谍案，员工们表面是同事，背地里却分属于A、B两家敌对公司。

### 3. 核心诡计复杂度 (Complex Core-Trick)
*   **描述：** 在核心案件的设计上，采用更精巧、更具挑战性的本格或变格推理诡计。
*   **实现方式：**
    *   **本格诡计：** 如“暴风雪山庄”（与外界隔绝）、“密室杀人”、“利用时间差/身份互换作案”等。
    *   **变格诡计：** 如“叙述性诡计”（剧本的描述本身就在欺骗玩家）、“超自然能力作案”（如神话、科幻主题中的法术或高��技）等。
    *   **要求：** 无论诡计多复杂，其最终解释必须合乎剧本世界观的内在逻辑，且有迹可循。

### 4. 非线性任务链 (Non-linear Task Chains)
*   **描述：** 玩家的任务不再是单一固定的，而是可以根据游戏进程或其他玩家的行为动态变化。
*   **实现方式：**
    *   在角色剧本中设置 **“阶段性任务”** 或 **“触发式任务”**。
    *   **阶段性任务示例：** 任务1：找出A的秘密 -> 完成后解锁任务2：说服A与你结盟。
    *   **触发式任务示例：** “如果B角色在第二幕指认你，你的新任务是：向所有人揭露B的一个秘密。”
    *   这能极大地提升游戏的重玩价值和玩家间的互动博弈。

---

## 四、剧本创作完整流程

这是一个标准化的工作流程，用于确保每个剧本的创作都保持高质量和一致性。

1.  **构思与规划 (Ideation & Planning):**
    *   确定新剧本的主题和名称。
    *   构思故事背景、核心冲突和角色列表。
    *   **（可选）** 决定是否引入“高级剧本设计元素”，并进行相应构思。

2.  **创建项目结构 (Project Scaffolding):**
    *   使用 `mkdir` 命令创建剧本的专属文件夹。

3.  **撰写核心剧本 (Script Writing):**
    *   **撰���GM手册：** 创建并完成 `GM_手册.md` 的撰写，遵循第二部分的核心要素。对于图片线索，使用 `[图片: ...]` 占位符。
    *   **撰写公共剧本和个人剧本。**

4.  **生成与整合插图 (Image Generation & Integration):**
    *   **配置脚本：** 打开 `generate_all_images.py` 脚本，在 `THEMES` 字典中为新剧本添加一个条目。
        *   **Key:** 为新剧本设置一个简短的英文缩写（例如 `jzy` 代表荆州宴）。
        *   **folder:** 填写剧本的文件夹名称。
        *   **scripts:** 为每个需要插图的 `.md` 文件（角色、GM手册、公共剧本）添加一个条目，包含`prompt`, `filename`, 和 `alt_text`。
        *   **clues:** 为每个图片线索添加一个条目，包含`prompt`, `filename`, `alt_text`, 和用于定位替换的 `placeholder_text`（即 `[图片: ...]` 中的文本）。
    *   **执行脚本（生成脚本图片）：**
        *   运行命令：`python generate_all_images.py --theme <theme_short_name> --target scripts`
        *   此命令会为所有角色和封面生成图片并自动插入。
    *   **执行脚本（生成并修复线索图片）：**
        *   运行命令：`python generate_all_images.py --theme <theme_short_name> --target clues`
        *   此命令会生成线索��片，并自动将GM手册中的占位符替换为图片链接。
    *   **验证：** 检查所有剧本文件夹，确保 `images` 文件夹已创建，并且所有 `.md` 文件中的图片���已正确显示。

5.  **项目收尾 (Finalization):**
    *   **更新主文档：** 更新根目录下的 `README.md` 文件，加入新完成的剧本及其简介。
    *   **检查完整性：** 确认所有文件都已就位，所有图片链接都已正确显示。